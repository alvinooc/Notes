- JS引擎会在执行代码之前在堆内存中创建一个全局对象：Global Object（GO）

  - 该对象所有的作用域（scope）都可以访问
  - 包含Data、Array、String、Number、setTimeout、setInterval等等
  - 其中还有一个window属性指向自

- JS引擎内部有一个**执行上下文栈（Execution Context Stack，简称ECS），用于执行全局的代码块**

- 全局的代码块为了执行会构建一个 **Global Execution Context（GEC）**

- GEC 会被放入到ECS中执行，其中包含两部分内容：

  - **第一部分**：在代码执行前，即parser转成AST的过程中，会将全局定义的变量、函数等加入到Global Object中，但是并不会赋值。该过程也称之为变量的作用域提升(hoisting)

  - **第二部分**：在代码执行中，对变量赋值或执行其他的函数

    ![image-20220414210505967](https://cdn.jsdelivr.net/gh/alvinooc/Notes@master/Image/image-20220414210505967.png)

    ![image-20220414210653561](https://cdn.jsdelivr.net/gh/alvinooc/Notes@master/Image/image-20220414210653561.png)

- 在执行到一个函数时，会根据函数体创建一个**函数的执行上下文（Functional Execution Context，简称FEC），**并且压入到EC Stack中。FEC中包含三部分内容：

  - 第一部分：在解析函数成为AST树结构时，会创建一个Activation Object（AO）

    - AO中包含形参、arguments、函数定义和指向函数对象、定义的变量

  - 第二部分：作用域链，由VO（在函数中就是AO对象）和父级VO组成，查找时会一层层查找

  - 第三部分：this绑定的值

    ![image-20220414210948671](https://cdn.jsdelivr.net/gh/alvinooc/Notes@master/Image/image-20220414210948671.png)

    ![image-20220414212759548](https://cdn.jsdelivr.net/gh/alvinooc/Notes@main/Image/image-20220414212759548.png)
